\chapter{Arquitetura proposta}

Conforme visto no capítulo anterior, é possível a integração de um sistema de manutenção inteligente
utilizando uma arquitetura orientada a serviços. Dessa forma, este capítulo apresenta a proposta de
uma arquitetura para um sistema de manutenção inteligente. São apresentadas as entidades principais
e a interligação entre elas através da utilização do padrão \gls{SOA}. As entidades que compõem a
arquitetura são descritas e inseridas no contexto de uma aplicação através de casos de uso. Através
dos casos de uso, são abordadas diferentes situações onde as entidades da arquitetura se encaixam
para resolver algum dos problemas.

\blindtext

\todo[inline]{Falar sobre o estudo de caso e programação dos experimentos.}


%%
\section{Arquitetura orientada a serviços proposta}

A arquitetura proposta neste trabalho tem por objetivo a integração de sistemas de manutenção
inteligente, dos diversos equipamentos que precisam ser monitorados, além de outras entidades que
auxiliam no funcionamento do sistema. A troca de informações entre todos os elementos que compõem a
arquitetura é abstraída na forma de serviços, o que facilita a integração, inserção e remoção de
novas entidades no sistema. Dessa forma, a especificação da arquitetura é definida utilizando os
padrões \gls{SOA}. Uma visão geral das entidades que fazem parte da arquitetura proposta é
apresentada na \cref{fig:soa-proposed-architecture}\todo{Alterar figura. A aplicação SOA deve
englobar mais entidades}. Na figura, nota-se que cada entidade tem uma função específica no sistema
e o acesso às suas funcionalidades é realizado através de serviços. A seguir, para melhor
entendimento, todos os elementos serão detalhados.

\includefigure
  {images/soa-proposed-architecture}
  {Arquitetura orientada a serviços proposta para integração de um sistema de manutenção
      inteligente.}
  {fig:soa-proposed-architecture}


%%%
\subsection{Serviço}

No contexto da arquitetura proposta neste trabalho, serviço é um componente de software que
encapsula uma funcionalidade acessível através dos padrões definidos pela tecnologia \gls{SOA}.
Todos os componentes da arquitetura expõem as suas funcionalidades na forma de serviços,
possibilitando que a interação entre eles seja feita de forma transparente. Como parte do padrão
\gls{SOA}, serviços podem ser descobertos e utilizados por clientes que desejam executar uma
determinada tarefa. Neste contexto, também é possível a definição de serviços mais especializados
com base em outros serviços, praticando a técnica da composição de serviços. Estas características
se tornam inerentes à proposta, devido a utilização do padrão \gls{SOA}.


%%%
\subsection{Dispositivo}

Um dispositivo é um componente de software utilizado para encapsular um elemento físico da aplicação
proposta. Por ser executado em um dispositivo físico, o componente é denominado dispositivo lógico e
disponibiliza serviços para acesso à funcionalidades previamente definidas. As funcionalidades podem
ser relativas ao dispositivo físico em que o componente está executando ou outras que auxiliam em
alguma tarefa específica não relacionada diretamente com o hardware hospedeiro.

Do ponto de vista da aplicação, os dispositivos são entidades que hospedam serviços. Dentre os
serviços hospedados, alguns estão presentes em todos os dispositivos da arquitetura, servindo de
base para a comunicação entre todos os elementos desta classe. Dessa forma, conhecendo os serviços
básicos, uma interface mínima para troca de informações entre as entidades do sistema é definida,
facilitando a inserção de novos dispositivos.

Além dos serviços base, outros podem ser executados no dispositivo. A arquitetura permite o envio de
novos serviços para os dispositivos do sistema. O dispositivo recebe o novo serviço, que possui as
mesmas funcionalidades de um serviço padrão, e o carrega para ser executado normalmente.


%%%
\subsection{Aplicação orientada a serviços}

A \todo{Alterar texto para englobar mais entidades da arquitetura}aplicação orientada a serviços
nada mais é do que o resultado da utilização dos diversos serviços propostos na arquitetura. Através
da composição ou utilização direta dos serviços de uma forma coordenada, a aplicação é construída.
De um modo minimalista, a aplicação pode ser vista como a interação progressiva de funcionalidades
simples provenientes de serviços básicos, resultando em um componente complexo de software. Visto
que o produto final da composição dos elementos do sistema não é definido \textit{a priori}, o
resultado da aplicação pode ser qualquer construção ou interação entre os componentes.


%%%
\subsection{Gerenciador de dispositivos}

Como o nome sugere, o Gerenciador de Dispositivos é um componente de software utilizado para
gerenciar os dispositivos da arquitetura proposta. A configuração ou obtenção da lista dos
dispositivos na aplicação orientada a serviços são exemplos de funcionalidades do gerenciador. Como
os dispositivos são entidades que mapeiam funcionalidades dos dispositivos físicos encontrados em um
sistema de manutenção inteligente, o gerenciador pode, por exemplo, obter a lista de sensores do
equipamento e configurar alguns parâmetros, como a taxa de atualização dos dados dos sensores.
Também é possível definir comportamentos adicionais para o caso do equipamento estar operando em
diferentes níveis de degradação. Os diferentes comportamentos podem ser utilizados quando há
necessidade de operar o equipamento em condições onde manter os níveis de degradação estáveis é mais
importante do que a operação a pleno. Portanto, pode-se manter o equipamento funcionando até que uma
manutenção \textit{in loco} possa ser realizada.

Grupos de dispositivos podem ser criados e gerenciados. O Gerenciador de Dispositivos permite a
criação de grupos, a fim de facilitar a alteração simultânea de vários dispositivos. Supondo que a
aplicação é inerentemente escalável, o número de dispositivos tente a aumentar, o que dificulta o
gerenciamento ou configuração de dispositivos similares. Considerando que as configurações aplicadas
a uma mesma classe de dispositivos é muito parecida, o gerenciador permite que um grupo receba os
mesmos parâmetros, automatizando o processo de customização dos dispositivos.

Outra funcionalidade que o gerenciador provê é a obtenção da topologia dos componentes do sistema.
Em uma arquitetura \gls{SOA} todos os serviços estão localizados no mesmo nível hierárquico. Essa
característica pode ser considerada positiva do ponto de vista de integração e reuso de serviços. Em
contrapartida, ao definir níveis hierárquicos entre componentes de um mesmo dispositivo físico, a
complexidade para o estabelecimento de uma hierarquia lógica para representação das diferentes
partes desse dispositivo aumenta. Contudo, ao aplicar um identificador único para cada dispositivo,
ou parte de dispositivo, do sistema, torna-se possível definir e estabelecer uma relação
hierárquica. O identificador pode ser uma \gls{URI}, por exemplo, onde cada parte do endereço se
refere a um dos níveis hierárquicos.

O Gerenciador de Dispositivos também é utilizado na resolução de problemas encontrados durante a
execução dos componentes do sistema. A entidade se enquadra na categoria de \gls{IHM},
possibilitando que a rede seja mapeada em busca de dispositivos ou serviços de forma interativa.
Além disso, é possível obter o estado dos dispositivo, visualizar dados ou testar os serviços
encontrados.


%%%
\subsection{Gerenciador de análises}

O Gerenciador de Análises é utilizado para definir o plano que será aplicado a determinado
equipamento, ou grupo de equipamentos, \todo{Em ou com?}com vista a obter os níveis de degradação.
Nesta entidade, é possível selecionar e definir a ordem em que serão executadas as ferramentas de
análise de dados através de um plano. O gerenciador permite o agendamento dos planos e a execução
periódica em intervalos de tempo. Os planos também podem ser gerenciados, possibilitando alteração
e/ou exclusão.

No plano são definidos os comportamentos a serem adotados com base nos valores de degradação do
equipamento. O gerenciador obtém os comportamentos previamente definidos para o equipamento a ser
analisado, os quais podem ser mapeados pelo usuário para diferentes níveis de degradação. Dessa
forma, o equipamento pode ser adaptado a diferentes condições, por exemplo, evitando o aumento da
degradação até que uma manutenção possa ser realizada.

Esta entidade também coordena as análises realizadas em um grupo de equipamentos similares. O
processo de obtenção dos valores de confiança de um conjunto de equipamentos pode ser simplificado
pelo fato de que, se são similares, o nível de degradação de um equipamento pode ser aproximado para
o nível de degradação do grupo. Dessa maneira, é possível elaborar um plano de análise que seja
aplicável a vários equipamentos.


%%%
\subsection{Analisador de dispositivos}

O Analisador de Dispositivos concentra todas as ferramentas necessárias para a realização da análise
dos dados de determinado dispositivo. A entidade opera com base nos planos criados e agendados pelo
\todo{Operador do sistema?}usuário no Gerenciador de Análises. De posse do plano, o analisador
executa as análises utilizando os algoritmos necessários para obtenção do resultado esperado. A
execução de um mesmo plano é feita de forma automática.

O analisador permite verificar quais planos estão sendo executados ou na fila para execução. Sempre
que um novo plano é encontrado, o analisador o coloca na fila de execução, a fim de que seja
finalizado o mais breve possível. A entidade permite o monitoramento destes planos pelo usuário, o
qual pode verificar se a execução está de acordo com o esperado.


%%%
\subsection{Base de dados}

A entidade Base de Dados é utilizada como uma interface para um banco de dados. O software encapsula
funcionalidades para  armazenar todos os dados relativos à aplicação. Desde os dados obtidos nas
análises de degradação dos equipamentos como também os planos de análise agendados pelo usuário. A
base centraliza as informações, mas não necessariamente faz com que a aplicação seja centralizada.
Nada impede a utilização de diferentes \todo{Remotas e locais? Alterar figura}bases de dados e o
compartilhamento de informações entre as entidade do sistema. Por exemplo, o armazenamento dos dados
de treinamento de um equipamento, necessário para obtenção do nível de degradação, pode ser feito em
diferentes bases de dados. O Analisador de Dispositivos pode combinar estas informações, a fim de
melhorar o resultado esperado.

Por ser defina como um componente \gls{SOA}, o acesso aos dados é feito através de serviços. A
inclusão, deleção e modificação de dados são realizadas por serviços especializados. Um dispositivo
remoto pode acessar a base de dados a fim de obter o histórico dos últimos valores de confiança
calculados ou valores de testes intermediários para determinado equipamento, utilizando-os para um
novo tipo de análise.


%%%
\subsection{Repositório de serviços}

O repositório de serviços é uma entidade que armazena os dispositivos lógicos e seus serviços, os
quais podem ser obtidos dinamicamente e implantados em dispositivos físicos. Esta entidade pode
estar localizada na rede local ou remota, com acesso disponível para várias aplicações. Dessa forma,
uma nova aplicação, isolada de outra já existente, pode ser construída com o reúso de componentes
obtidos de um repositório de serviços compartilhado pelas duas. Esta abordagem também permite o
compartilhamento de uma base de dados de componentes lógicos entre aplicações.


%%
\section{Casos de uso para a arquitetura proposta}

Os elementos que compõem a arquitetura proposta encaixam-se em alguns casos de uso no contexto de um
sistema de manutenção inteligente. Os casos de uso propostos a seguir exemplificam a interação do
operador do sistema na busca ou configuração dos dispositivos e na criação dos planos de análise
para cada dispositivo. Para a maioria dos casos de uso, o operador do sistema é considerado como
ator. Além disso a ferramenta de análise de dados é utilizada para analisar os dados obtidos dos
equipamentos monitorados. Visto que as análises executam autonomamente durante o processo de
amostragem dos equipamentos, uma tarefa periódica é vista como ator do caso de uso.


%%%
\subsection{Descoberta e configuração de dispositivos}

A descoberta dos dispositivos e serviços na rede pode ser feita a qualquer momento utilizando o
Gerenciador de Dispositivos. Cada um dos dispositivos encontrados é identificado e colocado em uma
lista de dispositivos ativos. Também são identificados os serviços hospedados em cada um dos
dispositivos. Dessa forma, é possível determinar quais dispositivos estão atualmente disponíveis na
rede e quais possuem serviços que poderão ser utilizados para suprir e executar determinada
funcionalidade do sistema.

A geração da hierarquia de recursos encontrados na rede também é possível. Ao aplicar um
identificador único para cada recurso, a reconstrução dos componentes do sistema pode ser obtida
agrupando-os em classes ou categorias. O identificador é utilizado para auxiliar a definir uma
topologia dos subdispositivos encontrados em um dispositivo lógico, facilitando a visualização e
configuração dos componentes.

O diagrama \gls{UML} de casos de uso para descoberta e configuração de dispositivos é apresentado na
\cref{fig:uml-discovery-setup-devices}. São ilustradas as interações que o operador do sistema pode
realizar nos dispositivos utilizando o Gerenciador de Dispositivos. Em vias gerais, o gerenciador
será utilizado pelo operador do sistema para descobrir os dispositivos da rede, obter o estado ou
realizar modificações nestes elementos.

\includefigure
  {images/uml-discovery-setup-devices}
  {Diagrama de casos de uso para descoberta e configuração de dispositivos.}
  {fig:uml-discovery-setup-devices}

Ao utilizar a descoberta de dispositivos, o gerenciador analisa todos dispositivos da aplicação
orientada a serviços. Os que forem encontrados são retornados, permitindo ao operador do sistema
verificar se a inclusão de um novo dispositivo foi concluída com êxito. Além disso, o gerenciador
permite obter o estado de cada elemento encontrado, o qual está relacionado ao funcionamento do
dispositivo, se está executando corretamente ou se está pronto para operação. Outras informações
também são obtidas utilizando os metadados. Esta funcionalidade lista dados como modelo, versão ou
fabricante do dispositivo.

Na configuração, o operador do sistema também deve informar os serviços de monitoramento dos
sensores do equipamento para enviar os dados à base de dados. Com as informações de acesso à base de
dados, o dispositivo pode enviar automaticamente os dados adquiridos dos sensores. Para evitar o
excesso de acessos à base, um montante de dados é adquirido e armazenado localmente pelo
dispositivo. Quando o montante estiver completo, é enviado diretamente para a base de dados. É
possibilitado ao operador do sistema configurar o número de amostras que o dispositivo irá adquirir
para compor o conjunto de dados. A \cref{fig:uml-configure-device-acquisition} apresenta o diagrama
\gls{UML} de casos de uso que ilustra a configuração do dispositivo para envio dos dados para a Base
de Dados.

\includefigure
  {images/uml-configure-device-acquisition}
  {Diagrama de casos de uso para a configuração do envio dos dados do dispositivo.}
  {fig:uml-configure-device-acquisition}

Outra funcionalidade que o Gerenciador de Dispositivos disponibiliza é a obtenção da topologia da
distribuição dos dispositivos na rede. Dispositivos e serviços no padrão \gls{SOA} sempre estão
localizados no mesmo nível hierárquico, o que dificulta o estabelecimento de uma hierarquia entre os
componentes. No entanto, pode-se definir uma hierarquia utilizando para isso o identificador de cada
dispositivo. O identificador -- uma \gls{URI}, por exemplo -- é único para cada dispositivo da
aplicação, possibilitando que, na inclusão de subdispositivos, o identificador seja estendido para
englobá-los. Além disso, pode-se criar classes e subclasses de dispositivos, organizando
funcionalidades comuns para determinado dispositivo. A visualização das duas topologias possíveis é
apresentada na \cref{fig:device-topology-visualization}. À esquerda, os dispositivos estão
distribuídos como são encontrados pelo Gerenciador de Dispositivos. Na direita, o gerenciador
reconstrói a topologia baseado nos identificadores únicos de cada dispositivo. Nota-se que os
dispositivos, que na primeira topologia estão no mesmo nível hierárquico, agora são encontrados como
subdispositivos de outros dispositivos.

\includefiguretmp
  {Possíveis visualizações da topologia dos dispositivos.}
  {fig:device-topology-visualization}

Tomando de exemplo a \cref{fig:device-topology-visualization}, os identificadores de cada
dispositivo poderiam ser construídos com um dispositivo pai englobando outros dois subdispositivos.
Tanto o dispositivo pai como os subdispositivos estão definidos dentro de escopos ou áreas e essas
informações estão incluídas no identificador.

% TODO: Talvez não seja necessária a inclusão de outra figura.
%\includefiguretmp
%  {Identificação dos dispositivos na topologia hierárquica.}
%  {fig:device-topology-identification}

Cada dispositivo pode armazenar diferentes comportamentos. Os comportamentos dizem respeito ao modo
de operação que o equipamento vai assumir perante determinada situação, sendo definidos pelo
operador do sistema. São diferentes tarefas que podem ser executadas pelo equipamento em situações
específicas. No caso de verificação de degradação excessiva de um equipamento, é possível alterar o
comportamento de funcionamento para outro que priorize a manutenção do estado de saúde atual,
evitando o aumento da degradação. Dessa forma, o equipamento pode operar por um período maior de
tempo até que uma manutenção possa ser realizada. Contudo, medidas que alteram o comportamento podem
levar a perda de desempenho nas tarefas executadas.

\iffalse
A \cref{fig:device-send-behavior} ilustra o envio de novos comportamentos pelo operador do sistema
para um dispositivo. O dispositivo mantém uma lista de comportamentos e seleciona qual o mais
adequado para a situação corrente. A situação é definida pelo nível de saúde obtido através das
análises de dados e representa a degradação de todo ou parte do equipamento.

\includefiguretmp
  {Envio de comportamentos para o dispositivo.}
  {fig:device-send-behavior}
\fi

%%%
\subsection{Envio de dados de treinamento}

Para obter o índice de degradação dos equipamento, as ferramentas de análise necessitam comparar os
dados obtidos durante o processo com dados de treinamento. Dentre os dados de treinamento, emergem
duas categorias: normal e falha. Os dados de funcionamento normal são obtidos quando o equipamento
está funcionando normalmente, enquanto que os dados de falha são obtidos quando o equipamento está
funcionando com algum tipo de degradação. A aquisição de ambos os tipos de dados são feitas em lugar
apropriado, tendo certeza das características de cada sinal.

O envio de dados de treinamento é feito através do Gerenciador de Dispositivos. O gerenciador
permite que o operador do sistema envie os dois tipo de dados, mapeando-os para um dispositivo ou
para um grupo de dispositivos. A \cref{fig:uml-send-training-data} apresenta os casos de uso para o
envio de dados de treinamento a um dispositivo.

\includefigure
  {images/uml-send-training-data}
  {Diagrama de casos de uso para envio de dados de treinamento para um dispositivo.}
  {fig:uml-send-training-data}


%%%
\subsection{Gerenciamento de análises}

O gerenciamento de análises é feito pelo operador do sistema utilizando a entidade Gerenciador de
Análises. As análises são definidas em planos, os quais apresentam informações sobre o dispositivo
analisado, quais dados serão utilizados e as ferramentas empregadas na manipulação dos dados. É
permitido o gerenciamento dos planos, como a criação, edição ou remoção, pelo operador do sistema.
Como os planos são armazenadas em uma base de dados, facilmente podem ser compartilhados com outras
instâncias do Gerenciador de Análises e utilizados por outros operadores do sistema.

As informações contidas em um plano de análise ditam como determinado equipamento será analisado. Em
um primeiro momento, o operador do sistema faz a busca pelos dispositivos utilizando o Gerenciador
de Dispositivos. Com a lista de dispositivos ativos, o Gerenciador de Análises é utilizado para
definir as operações a serem realizadas em um equipamento específico. Preenchendo o plano de
análise, o operador seleciona quais dados do equipamento serão utilizados e quais as ferramentas
utilizadas para analisá-los. O plano também permite definir o intervalo de execução de cada análise
e por quanto tempo o equipamento será analisado. O diagrama \gls{UML} de casos de uso para algumas
funcionalidades do Gerenciador de Análises é apresentado na \cref{fig:uml-analysis-management}. A
estrutura do plano é armazenada na entidade Base de Dados, sendo acessível para as outras entidades
que utilizam as informações do plano.

\includefigure
  {images/uml-analysis-management}
  {Diagrama de casos de uso para o gerenciamento de análises pelo operador do sistema.}
  {fig:uml-analysis-management}

Na construção do plano de análise, os comportamentos de cada dispositivo são obtidos e incluídos na
execução. Os diferentes comportamentos podem ser mapeados para intervalos de resultados esperados
das análises. Como descrito pelo diagrama de casos de uso da \cref{fig:uml-analysis-management}, a
\cref{fig:device-create-plan} ilustra a criação de um plano de análise de dispositivo. Após obter
todas as informações do dispositivo a ser analisado, o plano é criado pelo operador do sistema. Na
criação, são definidos os intervalos de reexecução do plano, bem como a ordem das ferramentas
utilizadas na manipulação dos dados.

\includefiguretmp
  {Busca de dispositivo e criação de um plano de análise.}
  {fig:device-create-plan}


%%%
\subsection{Análise dos dados do dispositivo}

As análises dos equipamentos do sistema, anteriormente agendadas na ferramentas de Gerenciamento de
Análises, são executadas pela entidade Analisador de Dispositivos. O analisador obtém os planos e os
executa conforme programado pelo operador do sistema. Conhecendo a frequência em que cada plano deve
ser executado, uma tarefa periódica é definida. Dessa forma, chegada a hora da reexecução de um
plano, a tarefa se comunica com o Gerenciador de Análises e o dispara. Os possíveis casos de uso
para a tarefa periódica são apresentados no diagrama \gls{UML} da \cref{fig:uml-device-analysis}. A
tarefa tem a possibilidade de obter os planos de análise ativos ou selecionar diretamente um plano
conhecido. Após a carga, a tarefa pode iniciar a execução do plano. Na execução, o Analisador de
Dispositivos seleciona as ferramentas de análise, busca os dados do equipamento e, ao final,
armazena os resultados na Base de Dados.

\includefigure
  {images/uml-device-analysis}
  {Diagrama de casos de uso para a obtenção e execução das análises.}
  {fig:uml-device-analysis}

A \cref{fig:analysis-plan-execution} apresenta o fluxo de dados quando da execução de um plano de
análise pelo Analisador de Dispositivos. O dispositivo é identificado e os seus dados são obtidos da
base de dados. As ferramentas de análise são selecionadas de acordo com o plano e os dados brutos
são analisados. O resultado da análise é novamente enviado para a base de dados. Se necessário,
novas análises são realizadas sobre os dados que já foram manipulados. Com o índice de degradação,
que é o resultado final da análise, o Analisador de Dispositivos seleciona um dos comportamentos
definidos no plano. O equipamento é então posto para executar a tarefa monitorada de acordo com o
novo comportamento.

\includefiguretmp
  {Diagrama de execução de uma análise de equipamento.}
  {fig:analysis-plan-execution}


%%%
%\subsection{Modos de operação do dispositivo}
%
%Os diferentes modos de operação dos dispositivos podem ser selecionados pelo operador do sistema e
%anexados ao plano de análise. O operador define, baseado nos níveis de degradação que podem ser
%obtidos, qual o melhor comportamento que o equipamento deve assumir. Com o plano, o Analisador de
%Dispositivos determina o índice de degradação do equipamento, verificando se está nos níveis
%desejados para determinado funcionamento. Dependendo do valor obtido na análise, o analisador pode
%alterar o funcionamento do equipamento, assumindo um dos comportamentos definidos anteriormente pelo
%operador do sistema. A \cref{fig:uml-device-operation-modes} apresenta o diagrama \gls{UML} de casos
%de uso para a seleção automática dos modos de operação do dispositivo baseado no plano de análise.
%
%\includefiguretmp
%  {Diagrama de casos de uso para seleção dos modos de operação suportados pelo dispositivo.}
%  {fig:uml-device-operation-modes}


%%%
\subsection{Relatórios de saúde}

A arquitetura proposta permite a obtenção dos relatórios de saúde dos dispositivos executando sobre
equipamentos monitorados pelo sistema de manutenção inteligente. Como todos os dados das análises
são armazenados na entidade Base de Dados, é possível, a qualquer momento, resgatá-los. A obtenção
dos relatórios dos dispositivos é possível com o uso do Gerenciador de Dispositivos. Os casos de uso
para obtenção dos relatórios de um dispositivo ou de um grupo de dispositivos são apresentados no
diagrama \gls{UML} da \cref{fig:uml-health-device-report}.

\includefigure
  {images/uml-health-device-report}
  {Diagrama de casos de uso para obtenção dos relatórios de saúde do dispositivo.}
  {fig:uml-health-device-report}


%%
\section{Estudo de caso}

\todo[inline]{Introdução da seção mostrando que a sistema será simulado com os dados obtidos em
trabalhos anteriores.}


%%%
\subsection{Visão geral do objeto de estudo de caso}

O objeto de estudo de caso deste trabalho é um conjunto atuador elétrico e válvula. Um atuador
elétrico permite a abertura e fechamento motorizado de válvulas através da movimentação de uma
haste. Dessa forma, válvulas são encontradas em diversas aplicações onde seja necessário o controle
de fluxo de fluidos, como, por exemplo, água, esgoto ou petróleo. Para cada aplicação, é indicado um
tipo diferente de válvula. Os tipos mais comuns são esfera, gaveta e
globo~\cite{campos2006controles}.

O conjunto atuador elétrico e válvula, utilizado no trabalho em questão, é utilizado para controle
de fluxo em redes de distribuição de petróleo\todo{Modelo do atuador}. É possível a obtenção do
torque mecânico exercido pelo atuador sobre as engrenagens de comando da haste bem como a posição do
obturador. O acionamento do conjunto pode ser feito localmente, através de uma interface de
programação local, sendo que todos os elementos de controle estão incorporados no próprio
equipamento. O atuador utilizado é dito de comando inteligente, pois, além de estar instrumentado,
possui a capacidade de detecção de alguns problemas, como sobreaquecimento, torque excessivo ou
falta de fase.

Durante o funcionamento, os valores de torque e posição da haste são armazenados em uma memória
interna do atuador, sendo possível registrar até \num{500} operações de fechamento ou abertura. No
entanto, as medidas obtidas pelo atuador não são suficientes para utilização em um sistema de
detecção de falhas. Uma das causas é a baixa resolução com que os dados são adquiridos, sendo de
\SI{1}{\newton\meter} e a cada 5\% de abertura para um fundo de escala de \SI{60}{\newton\meter}.
Além disso, como forma de detectar facilmente o início e o fim do movimento do atuador, o torque é
truncado para \SI{10}{\newton\meter} quando os valores forem menores que \SI{10}{\newton\meter} e,
quando não há movimento, assume o valor de \SI{0}{\newton\meter}~\cite{lazzaretti2012avaliacao}.

\includefigure
  {images/csr6-device}
  {Atuador elétrico modelo CSR6.}
  {fig:csr6-device}

O atuador foi montado em uma bancada de testes onde é possível a simulação das condições de desgaste
do conjunto e a instrumentação de partes que não são verificadas por padrão. Dessa forma, na
bancada, o atuador está instrumentado com mais três sensores, visando a obtenção dos níveis de
vibração da estrutura. Os sensores são acelerômetros, posicionados no eixo do motor do atuador, na
ponta do sem-fim e na pinça do freio. A \cref{fig:study-case} apresenta a bancada de testes
utilizada no estudo de caso enquanto que a \cref{fig:sensors-localization} ilustra o posicionamento
dos sensores instalados e a estrutura interna do atuador.

\todo[inline]{Modelo do atuador elétrico no SolidWorks.}

\includefiguretmp
  %{images/study-case}
  {Bancada de testes utilizada no estudo de caso.}
  {fig:study-case}

\includefiguretmp
  %{images/sensors-localization}
  {Diagrama da localização dos sensores instalados no atuador elétrico.}
  {fig:sensors-localization}

A bancada também conta com um sistema de freio a disco instalado no eixo do atuador, o que
possibilita a simulação dos esforços mecânicos exercidos pelo fluxo de fluido durante a abertura e
fechamento da válvula. A simulação do desgaste é feita pela troca de engrenagens com diferentes
níveis de degradação. No total são três engrenagens, uma em estado normal e outras duas apresentando
falha. Das engrenagens com falha, uma está desgastada e a outra possui uma parte quebrada. As três
engrenagens utilizadas no estudo de caso são ilustradas na \cref{fig:test-gears}.

\includefiguretmp
  %{images/test-gears}
  {Engrenagens utilizadas no estudo de caso.}
  {fig:test-gears}

As engrenagens fazem parte do conjunto de engrenagens satélite do atuador. Este conjunto é
responsável pela transmissão do movimento do motor para a haste da válvula. A posição do conjunto de
engrenagens satélite é apresentada na \cref{fig:sattelite-gears-location}. O sensor de torque, que
faz parte do conjunto sem necessidade de modificação na estrutura, está acoplado ao eixo de
acionamento do torque e também está identificado na mesma figura.

\includefigure
  {images/sattelite-gears-location}
  {Localização das engrenagens satélite no atuador elétrico.}
  {fig:sattelite-gears-location}


%%%
\subsection{Definição dos dispositivos}

O conjunto utilizado como estudo de caso foi mapeado para a representação de dispositivos da
arquitetura proposta.

No contexto deste trabalho, um dispositivo é a entidade lógica principal que abstrai um elemento da
aplicação. Pode representar uma entidade física, como um sensor ou atuador, ou lógica, como uma
máquina, composta por diversas entidades de hardware mapeadas como entidades lógicas. Cada um dos
dispositivo hospeda serviços, representando tarefas ou funcionalidades específicas possíveis de
serem executadas. Tanto os dispositivos, bem como os serviços por eles hospedados, podem ser
descobertos e identificados na rede. Os dispositivos podem descobrir outros dispositivos e utilizar
os serviços do segundo, a fim de criar um serviço composto mais complexo para execução de
determinada tarefa. A \cref{fig:device-services-overview} ilustra a topologia para os dispositivos
utilizada neste trabalho. Os clientes utilizam os serviços hospedados pelos dispositivos
diretamente. Um serviço também pode ser considerado um cliente caso utilize de uma funcionalidade
remota para prover a sua funcionalidade ou tarefa. Além disso, da mesma forma, um dispositivo também
pode ser considerado um cliente, o que flexibiliza a integração entre os componentes do sistema.

\includefigure
    {images/device-services-overview}
    {Visão geral dos clientes, dispositivos e serviços hospedados.}
    {fig:device-services-overview}

\iffalse
O modelo de dispositivos empregados neste estudo é apresentado na figura\todo{Incluir figura}. Nela,
o dispositivo físico é abstraído por um dispositivo lógico, identificado por\textit{XX*}. O
dispositivo lógico inclui alguns serviços padrão, referenciando funcionalidades que podem ser
encontradas em todos os dispositivos presentes na arquitetura proposta. Dentre os serviços padrão,
tem-se o serviço de implantação de novos serviços. Este serviço permite que outros serviços sejam
adicionados ao dispositivo físico. Além disso, é possível a implantação de novos dispositivos
lógicos, a fim de abstrair componentes da aplicação, juntamente com serviços do
usuário\todo{Melhorar o texto com base na imagem que será incluída.}.
\fi

\includetable
  {tables/device-metadata}
  {Metadados disponíveis para configuração em cada dispositivo.}
  {tab:device-metadata}


\includetable
  {tables/sensor-info}
  {Parâmetros configuráveis dos sensores.}
  {tab:sensor-info}



%%%
\subsection{Aquisição dos dados}

Os dados foram obtidos de acordo com os trabalhos de~\cite{boesch2011deteccao} e
\cite{faccin2011manutencao}. Segundo os autores, a aquisição dos dados foi feita através de um
sistema desenvolvido em LabVIEW utilizando o chassis {cRIO-9104} e o módulo para aquisição dos dados
de vibração {NI-9233}. Os dados foram coletados durante seis situações distintas, onde, para cada
situação, foram obtidos \num{25} conjuntos de dados de abertura e \num{25} de fechamento da válvula,
o que representa um total de \num{300} curvas de experimentos. As situações foram: utilização de
engrenagens em perfeito estado e sem acionamento do freio mecânico; engrenagens em perfeito estado e
acionamento do freio mecânico com pressão de \SI{1}{\bar}; engrenagens em perfeito estado e
acionamento do freio mecânico com pressão de \SI{3}{\bar}; utilização de uma engrenagem desgastada
sem acionamento do freio; três engrenagens desgastadas sem acionamento do freio; uma das engrenagens
com dentes quebrados sem acionamento do freio mecânico.

Os dados de cada experimento foram amostrados a uma taxa de \SI{2048}{S\per\second}. Dessa forma,
cada conjunto de abertura ou fechamento da válvula tem duração aproximada de \SI{45}{\second}. Para
tornar o processamento dos dados menos custoso, uma subamostragem para a taxa de
\SI{1024}{S\per\second} foi realizada. Segundo~\cite{faccin2011manutencao}, a subamostragem dos
dados não prejudica o resultado da análise, porém torna o processamento menos custoso.


%%%
\subsection{Análise de degradação}

A análise de degradação do atuador é feita utilizando somente um dos três sensores citados
anteriormente. De acordo com os trabalhos de~\cite{boesch2011deteccao} e
\cite{faccin2011manutencao}, o acelerômetro acoplado ao eixo do motor é o que apresenta melhores
resultados para a detecção na degradação das engrenagens do atuador. Como apresentado
em~\cite{lazzaretti2012avaliacao}, os dados que apresentam melhores resultados para a obtenção dos
níveis de degradação são as curvas de abertura da válvula, devido a maior força que é exercida na
sede da válvula.

Os sinais de vibração não são estacionários. Para analisá-los, obtendo as características variantes
no tempo, técnicas de processamento de tempo e frequência são as mais indicadas. Portanto, a
extração das características dos sinais pode ser feita utilizando \gls{WPE}. A eficácia do uso deste
método para obtenção das características de sinais variantes no tempo é descrita no trabalho
de~\cite{qiu2006wavelet}.

Considerando a forma como os dados foram obtidos, pode-se supor que o atuador opera em três
situações distintas: em falha, em funcionamento normal e em teste. O funcionamento em falha se
refere à operação utilizando uma das engrenagens com dentes quebrados sem acionamento do freio
mecânico. O modo normal é definido com a operação quando é sabido que nenhuma das engrenagens
apresenta estado de degradação e o freio mecânico não é utilizado. Por fim, o modo de teste é aquele
onde o equipamento está sendo analisado, a fim de determinar o nível de degradação.

Os três tipos de situações definidas pela extração dos dados podem ser utilizadas para treinamento
do equipamento. Dessa forma, como apontado em~\cite{lazzaretti2012avaliacao}, uma das forma de se
fazer o treinamento do equipamento é utilizando o método da Regressão Logística.

%%
\section{Definição dos experimentos}

Os experimentos a serem realizados tem por base validar a proposta apresentada neste trabalho.


%%%
\subsection{Comparação da proposta em relação aos métodos tradicionais}


%%%
\subsection{Comparação dos métodos em relação a escalabilidade}


\iffalse
%%
\section{Definição das entidades}


%%%
\subsection{Gerenciador de dispositivos}


%%%%
\subsubsection{Dados de treinamento}

\todo[inline]{Configurar o dispositivo para enviar os dados de treinamento automaticamente.}


%%%
\subsection{Gerenciador de análises}


%%%
\subsection{Analisador de dispositivos}


%%%
\subsection{Base de dados}

\includefiguretmp
  %{images/database-schema}
  {Esquema utilizado na base de dados.}
  {fig:database-schema}
\fi
